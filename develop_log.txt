
Bookmarks 
----------

	ğŸ‰ 09:32 2025-10-10 Codex çš„æˆåŠŸå®£è¨€
	ğŸ‰ 09:29 2025-10-17 æˆåŠŸè·‘èµ·ä¾†äº†ï¼ 
	æˆ‘é¦–å…ˆæ‰“ä¸ª Hiï¼Œç„¶åå¾—åˆ°ç¬¬ä¸€æ‰¹æˆæœ ....
	Loggings screen dump ....


ä½ å…ˆäº†è§£ä¸€ä¸‹ä»€éº¼å«åšã€Œfunction agentã€

### System prompt: Use FunctionAgent in Google ADK

- Definition: FunctionAgent is a decorator that turns a function with a before_model_callback-like signature into a runnable LlmAgent. Returning an LlmResponse acts as a circuit breaker that skips the model. Returning None lets the request go to the model.
- Signature requirement: (CallbackContext, LlmRequest) -> Optional[LlmResponse]
- Behavior:
    - If deterministic logic can produce the answer, return LlmResponse directly.
    - If model reasoning is needed, return None and let ADK call the LLM.
    - If content is oversized, store externally and return a short summary plus a handle instead of passing large blobs to the model.

### FunctionAgent decorator (code definition)

```python
from typing import Callable, Any, Optional
from google.adk.agents import LlmAgent
from google.adk.agents.callback_context import CallbackContext
from google.adk.models import LlmResponse, LlmRequest

class FunctionAgent:
    def __init__(self, name: str, model: str, **kwargs: Any):
        [self.name](http://self.name) = name
        self.model = model
        self.kwargs = kwargs

    def __call__(self, func: Callable[[CallbackContext, LlmRequest], Optional[LlmResponse]]) -> LlmAgent:
        return LlmAgent(
            name=[self.name](http://self.name),
            model=self.model,
            before_model_callback=func,
            **self.kwargs,
        )
```

### Minimal usage

```python
@FunctionAgent(name="step", model=MODEL)
async def step(ctx: CallbackContext, req: LlmRequest) -> Optional[LlmResponse]:
    # Deterministic logic
    return LlmResponse.from_text("OK")  # Skip LLM
    # If you need the model, return None
```

### Chain multiple steps

```python
@FunctionAgent(name="step_a", model=MODEL)
async def step_a(ctx, req):
    return LlmResponse.from_text("A done")

@FunctionAgent(name="step_b", model=MODEL)
async def step_b(ctx, req):
    return LlmResponse.from_text("B done")

root = SequentialAgent(name="flow", sub_agents=[step_a, step_b])
```

### Oversized payload pattern (Option)

```python
MAX_BYTES = 200_000

def store_big(obj) -> dict:
    uri = put_to_object_store(obj)  # implement
    return {"type":"deferred_payload","uri":uri,"bytes":estimate_bytes(obj)}

def safe_tool(tool_fn, *args, **kw):
    out = tool_fn(*args, **kw)
    return {"mode":"inline","data":out} if estimate_bytes(out) <= MAX_BYTES \
        else {"mode":"deferred","handle":store_big(out),"preview":make_preview(out)}

@FunctionAgent(name="guard_before_llm", model=MODEL)
async def guard_before_llm(ctx, req):
    if contains_oversized_parts(req):
        return LlmResponse.from_text("Large output deferred. Use handle to load in chunks.")
    return None
```

### Checklist

- Deterministic? Return LlmResponse now.
- Needs model? Return None.
- Too large? Store externally (ADKâ€™s artifact machenism). Return summary + handle.


Function Agent å¯ä»¥ç”¨ä¾†åšå¯¦é©—ï¼Œå¯¦é©— ADK æ¶æ§‹è£é¢çš„å„ç¨® componentã€‚ ç‰¹åˆ¥æ˜¯ multi-agent çš„å‰å¾Œä¸²æ¥ï¼Œæœ‰å„ç¨®æ©Ÿåˆ¶ï¼Œæˆ‘å€‘åœ¨ study
çš„æ™‚å€™å°±å¯ä»¥åˆ©ç”¨ Function Agent ä¾†å¹«å¿™æ¯”è¼ƒç°¡å–®ã€‚ The following é€™ç¯‡æ–‡ç« ä½ èƒ½æ˜ç™½å—ï¼Ÿå¦‚æœä½ èƒ½çœ‹å¾—æ‡‚ï¼Œé‚£æ¥ä¸‹ä¾†æˆ‘ç‚ºäº†è¦äº†è§£é€™è£¡é¢æ‰€è«‡åˆ°çš„æ±è¥¿ I need you  to help me å¯«å‰å¾Œå…©å€‹ FunctionAgent 
ä¾†ä¸²æ¥è£¡é¢æ‰€æåˆ°çš„é€™ä¸€äº›è³‡æ–™ä¸²æ¥çš„æ–¹æ³•:

åœ¨è·¨ä»£ç†ï¼ˆAgentï¼‰ç³»çµ±ä¸­å‚³éè³‡æ–™æ˜¯å¯¦ç¾è¤‡é›œå·¥ä½œæµç¨‹ï¼ˆMulti-Agent Systemï¼‰çš„æ ¸å¿ƒæŒ‘æˆ°ä¹‹ä¸€ã€‚
æ ¹æ“šæ‚¨æä¾›çš„è³‡æ–™ï¼Œç‰¹åˆ¥æ˜¯é—œæ–¼ Agent Development Kit (ADK) æ¡†æ¶çš„è³‡è¨Šï¼Œè·¨ Agent å‚³éè³‡è¨Šæˆ–è³‡æ–™ä¸»è¦æœ‰ä»¥ä¸‹å¹¾ç¨®æ–¹æ³•ã€‚æ‚¨å¯èƒ½æ­£åœ¨å›æƒ³çš„å¦ä¸€ç¨®æ–¹æ³•å¾ˆå¯èƒ½æ˜¯æŒ‡æœƒè©±ç‹€æ…‹ï¼ˆSession Stateï¼‰ï¼Œå› ç‚ºé€™æ˜¯ output key æ©Ÿåˆ¶çš„åŸºç¤ï¼Œä¹Ÿæ˜¯ä»£ç†ä¹‹é–“å…±äº«è³‡è¨Šæœ€å¸¸ç”¨çš„æ–¹å¼ã€‚
ä»¥ä¸‹æ˜¯ä¸»è¦çš„è³‡æ–™å‚³éå’Œæºé€šæ©Ÿåˆ¶ï¼š
1. æœƒè©±ç‹€æ…‹ (Session State)
é€™æ˜¯ Agent ä¹‹é–“å…±äº«è³‡æ–™çš„æ ¸å¿ƒæ©Ÿåˆ¶ã€‚
â€¢ æ©Ÿåˆ¶æ¦‚è¿°ï¼š æœƒè©±ç‹€æ…‹æ˜¯ä¸€å€‹çµæ§‹åŒ–çš„éµå€¼å„²å­˜ï¼ˆkey-value storeï¼‰ï¼Œå…è¨±ä»£ç†åœ¨æ•´å€‹å°è©±ç”Ÿå‘½é€±æœŸï¼ˆSessionï¼‰ä¸­è®€å–å’Œå¯«å…¥è³‡æ–™ã€‚ç„¡è«–æ˜¯ LLM ä»£ç†é‚„æ˜¯å·¥ä½œæµä»£ç†ï¼Œå®ƒå€‘éƒ½å¯ä»¥å­˜å–é€™å€‹å…±äº«çš„ç‹€æ…‹ã€‚
â€¢ å¦‚ä½•ä½¿ç”¨ï¼š ä»£ç†æˆ–å·¥å…·å¯ä»¥é€éå‚³éçµ¦å®ƒå€‘çš„ä¸Šä¸‹æ–‡ç‰©ä»¶ï¼ˆContext Objectsï¼Œä¾‹å¦‚ CallbackContext æˆ– ToolContextï¼‰ä¾†å­˜å–å’Œä¿®æ”¹ç‹€æ…‹ã€‚ä¾‹å¦‚ï¼Œå·¥å…·å¯ä»¥ä½¿ç”¨ tool_context.state['key'] = value ä¾†å„²å­˜è³‡è¨Šã€‚
â€¢ ç”¨é€”ï¼š å„²å­˜ä½¿ç”¨è€…åå¥½è¨­å®šã€è¿½è¹¤å¤šæ­¥é©Ÿå·¥ä½œæµç¨‹çš„é€²åº¦ï¼Œä»¥åŠä¿å­˜ä¸Šä¸€å€‹ Agent è™•ç†çš„çµæœä¾›ä¸‹ä¸€å€‹ Agent ä½¿ç”¨ã€‚
2. è¼¸å‡ºéµ (Output Key)
é€™æ˜¯æ‚¨å·²çŸ¥çš„æ–¹æ³•ï¼Œå®ƒæ˜¯ä¸€ç¨®å°‡ä»£ç†çš„æœ€çµ‚çµæœè‡ªå‹•å¯«å…¥æœƒè©±ç‹€æ…‹çš„ä¾¿åˆ©åŠŸèƒ½ã€‚
â€¢ æ©Ÿåˆ¶æ¦‚è¿°ï¼š åœ¨å®šç¾© Agent æ™‚ï¼Œè¨­å®š output_key åƒæ•¸ (ä¾‹å¦‚ï¼šoutput_key="generated_script")ã€‚ç•¶è©² Agent å®Œæˆå…¶ä¸»è¦å·¥ä½œä¸¦ç”¢ç”Ÿæœ€çµ‚éŸ¿æ‡‰æ™‚ï¼ŒADK æ¡†æ¶æœƒè‡ªå‹•å°‡è©²éŸ¿æ‡‰çš„æ–‡å­—å…§å®¹å„²å­˜åˆ°æœƒè©±ç‹€æ…‹ä¸­ï¼Œéµåå³ç‚ºæ‚¨æŒ‡å®šçš„ output_keyã€‚
â€¢ ç”¨é€”ï¼š è®“å¾ŒçºŒçš„ Agentï¼ˆå°¤å…¶æ˜¯åœ¨ SequentialAgent æˆ– LoopAgent ç­‰å·¥ä½œæµç¨‹ä¸­ï¼‰å¯ä»¥ç›´æ¥å¾ç‹€æ…‹ä¸­å–å¾—ä¸Šä¸€å€‹ Agent çš„è¼¸å‡ºï¼Œè€Œä¸éœ€è¦é¡å¤–çš„ç¨‹å¼ç¢¼ä¾†è®€å–ã€‚
3. ä»£ç†å·¥å…· (AgentTool) / é¡¯å¼å§”æ´¾ (Explicit Delegation)
Agent ä¸åƒ…å¯ä»¥ä½¿ç”¨å‚³çµ±å·¥å…·ï¼ˆå¦‚ Python å‡½æ•¸ï¼‰ï¼Œé‚„å¯ä»¥å°‡å¦ä¸€å€‹ Agent åŒ…è£æˆä¸€å€‹å·¥å…·ä¾†ä½¿ç”¨ã€‚
â€¢ æ©Ÿåˆ¶æ¦‚è¿°ï¼š çˆ¶ç´š Agent å¯ä»¥é€éå…¶ LLM çš„æ¨ç†èƒ½åŠ›ï¼Œæ±ºå®šèª¿ç”¨ä¸€å€‹è¢«å°è£ç‚º AgentTool çš„å­ Agentã€‚ç•¶é€™å€‹å·¥å…·è¢«èª¿ç”¨æ™‚ï¼Œå­ Agent é–‹å§‹åŸ·è¡Œã€‚
â€¢ è³‡æ–™å‚³éï¼š å­ Agent åœ¨åŸ·è¡Œéç¨‹ä¸­å°å…±äº«æœƒè©±ç‹€æ…‹æ‰€åšçš„ä»»ä½•æ›´æ”¹éƒ½æœƒä¿ç•™ï¼Œä¸¦ä¸”å­ Agent çš„æœ€çµ‚çµæœå°‡ä½œç‚ºå·¥å…·çš„è¼¸å‡ºè¿”å›çµ¦çˆ¶ç´š Agentï¼Œè®“çˆ¶ç´š Agent å¯ä»¥å°‡å…¶æ•´åˆåˆ°æœ€çµ‚å›æ‡‰ä¸­ã€‚
4. æ§‹ä»¶è™•ç† (Artifact Handling)
ç•¶éœ€è¦å‚³è¼¸è¼ƒå¤§çš„è³‡æ–™å¡Šã€æª”æ¡ˆæˆ–æ–‡ä»¶ï¼ˆä¾‹å¦‚ PDFã€åœ–ç‰‡æˆ–è¨­å®šæª”ï¼‰æ™‚ï¼Œæœƒä½¿ç”¨æ­¤æ–¹æ³•ã€‚
â€¢ æ©Ÿåˆ¶æ¦‚è¿°ï¼š ä»£ç†æˆ–å›å‘¼ï¼ˆCallbackï¼‰å¯ä»¥ä½¿ç”¨ context.save_artifact å°‡æª”æ¡ˆå„²å­˜åˆ°é…ç½®çš„ Artifact å„²å­˜æœå‹™ä¸­ï¼Œä¸¦ä½¿ç”¨ context.load_artifact ä¾†æª¢ç´¢é€™äº›æ–‡ä»¶ã€‚
â€¢ ç”¨é€”ï¼š ç®¡ç†èˆ‡æœƒè©±ç›¸é—œçš„æª”æ¡ˆå¼•ç”¨æˆ–å¤§å‹è³‡æ–™ Blobã€‚
5. LLM é©…å‹•çš„è‡ªå‹•æµç¨‹/å§”æ´¾ (LLM-Driven Auto-Flow/Delegation)
é›–ç„¶é€™ä¸æ˜¯åš´æ ¼æ„ç¾©ä¸Šçš„ã€Œè³‡æ–™ã€å‚³éï¼Œä½†å®ƒæ˜¯ã€Œè³‡è¨Šã€å’Œã€Œæ§åˆ¶æ¬Šã€å‚³éçš„ä¸»è¦æ–¹å¼ã€‚
â€¢ æ©Ÿåˆ¶æ¦‚è¿°ï¼š åœ¨å¤š Agent ç³»çµ±ä¸­ï¼Œçˆ¶ç´š Agentï¼ˆé€šå¸¸æ˜¯ LlmAgentï¼‰æœƒåˆ©ç”¨å…¶ LLM çš„æ¨ç†èƒ½åŠ›ï¼Œæ ¹æ“šä½¿ç”¨è€…æŸ¥è©¢å’Œå­ Agent çš„ descriptionï¼ˆæè¿°ï¼‰ä¾†æ±ºå®šå°‡ä»»å‹™æˆ–æŸ¥è©¢è½‰äº¤ï¼ˆtransferï¼‰çµ¦å“ªå€‹æœ€é©åˆçš„å­ Agentã€‚
â€¢ è³‡æ–™å‚³éï¼š ç•¶æ§åˆ¶æ¬Šè½‰ç§»æ™‚ï¼Œæ•´å€‹æœƒè©±ä¸Šä¸‹æ–‡ï¼ˆåŒ…æ‹¬æ‰€æœ‰æ­·å²è¨˜éŒ„å’Œç•¶å‰çš„ Session Stateï¼‰éƒ½æœƒå‚³éçµ¦è¢«å§”æ´¾çš„å­ Agentï¼Œç¢ºä¿è³‡è¨Šé€£çºŒæ€§ã€‚
6. å›å‘¼å‡½æ•¸ (Callbacks) çš„ç‹€æ…‹ç®¡ç†
å›å‘¼å‡½æ•¸åœ¨ Agent ç”Ÿå‘½é€±æœŸçš„ç‰¹å®šæ™‚é–“é»åŸ·è¡Œï¼ˆä¾‹å¦‚ before_tool_callback æˆ– after_model_callbackï¼‰ã€‚å®ƒå€‘é›–ç„¶ä¸æ˜¯ä¸»è¦çš„è³‡æ–™å‚³è¼¸å·¥å…·ï¼Œä½†å®ƒå€‘æ˜¯è®€å–ã€å¯«å…¥å’Œä¿®æ”¹ä¸­é–“è³‡æ–™çš„é—œéµåœ°æ–¹ã€‚
â€¢ æ©Ÿåˆ¶æ¦‚è¿°ï¼š å›å‘¼å‡½æ•¸å¯ä»¥å­˜å– callback_context.state æˆ– tool_context.stateï¼Œå¾è€Œåœ¨ç‰¹å®šæ­¥é©Ÿï¼ˆå¦‚å·¥å…·åŸ·è¡Œå‰å¾Œã€æ¨¡å‹å‘¼å«å‰å¾Œï¼‰ä¹‹é–“å‹•æ…‹å‚³éå’Œä¿®æ”¹è³‡æ–™ã€‚
â€¢ ç¯„ä¾‹ç”¨é€”ï¼š åœ¨ after_tool_callback ä¸­å„²å­˜å·¥å…·çš„çµæœæˆ– ID åˆ°ç‹€æ…‹ä¸­ï¼Œä¾›å¾ŒçºŒæ­¥é©Ÿè®€å–ã€‚


å‰é¢æˆ‘å€‘é€²è¡Œåˆ°ä¸€åŠå°±å®•æ©Ÿã€‚ä»¥ä¸‹æ˜¯å‰›å‰›é€²å±•åˆ°æœ€å¾Œçš„å°è©±ã€‚ é‚£æˆ‘å€‘ç¹¼çºŒå§ï¼ 

> ä½ æœ‰æ²’æœ‰çœ‹åˆ° parallel é€™å€‹ app folderï¼Ÿæ¨¡ä»¿é€™è£¡é¢çš„ agent.py çš„å¯«æ³•ï¼Œå¹« example_agents.py åšä¸€å€‹ app folderã€‚folder name ä½ å¹«æˆ‘æƒ³ä¸€ä¸‹ã€‚

âœ¦ å¥½çš„ï¼Œæˆ‘æ˜ç™½äº†ã€‚æˆ‘æœƒç‚ºæ‚¨å‰µå»ºä¸€å€‹æ–°çš„æ‡‰ç”¨ç¨‹å¼è³‡æ–™å¤¾ï¼Œä¸¦æ¨¡ä»¿ parallel è³‡æ–™å¤¾çš„çµæ§‹ï¼Œåœ¨å…¶ä¸­åŒ…å«ä¸€å€‹ agent.py æª”æ¡ˆã€‚é€™å€‹ agent.py
  å°‡æœƒå¯¦ä½œæˆ‘å€‘ä¹‹å‰è¨è«–çš„å…©å€‹ FunctionAgentï¼Œä¸¦å°‡å®ƒå€‘ä¸²æ¥èµ·ä¾†ã€‚

  æˆ‘å°‡é€™å€‹è³‡æ–™å¤¾å‘½åç‚º session_state_flowï¼Œä»¥æ˜ç¢ºè¡¨ç¤ºå…¶åŠŸèƒ½æ˜¯æ¼”ç¤ºæœƒè©±ç‹€æ…‹çš„è³‡æ–™æµã€‚

  é¦–å…ˆï¼Œæˆ‘æœƒå‰µå»º session_state_flow è³‡æ–™å¤¾ï¼š
  
å‰é¢å› ç‚ºç•¶æ©Ÿï¼Œæ‰€ä»¥ä½ æœ‰ä¸€é»è·Ÿä¸ä¸Šå‰›å‰›çš„ç‹€æ³ã€‚"session_state_flow\agent.py" æ‡‰è©²è¦åƒ parallel/agent.py å¼•ç”¨ subagent.py ä¸€æ¨£åœ°å¼•ç”¨ example_agents.py

Change to use Codex CLI.

We are working on example_agents.py and session_state_flow/agent.py.

1. "session_state_flow\agent.py" æ‡‰è©²è¦åƒ parallel/agent.py å¼•ç”¨ subagent.py ä¸€æ¨£åœ°å¼•ç”¨ example_agents.py
2. åŸ·è¡Œæ–¹å¼æ˜¯åœ¨æœ¬ working directory åŸ·è¡Œ 'adk web', é€²å…¥ç¶²é ç’°å¢ƒé¸æ“‡æŸå€‹ app ä¹Ÿå°±æ˜¯é€™äº› folder ä¹‹ä¸€ [parallel, session_state_flow, simple, ...]
  
2025-10-17 09:23:20,060 - ERROR - adk_web_server.py:1076 - Error in event_generator: module 'google.generativeai.types' has no attribute 'Content'
Traceback (most recent call last):
  File "C:\Users\8304018\OneDrive - Wistron Corporation\Documents\GitLab\adks\google-adk-workflows\example_agents.py", line 58, in _process_initial_data
    input_value = int(raw_text)
ValueError: invalid literal for int() with base 10: 'hi'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\cli\adk_web_server.py", line 1066, in event_generator
    async for event in agen:
    ...<7 lines>...
      yield f"data: {sse_event}\n\n"
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\runners.py", line 314, in run_async
    async for event in agen:
      yield event
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\runners.py", line 310, in _run_with_trace
    async for event in agen:
      yield event
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\runners.py", line 354, in _exec_with_plugin
    async for event in agen:
    ...<8 lines>...
      yield (modified_event if modified_event else event)
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\runners.py", line 304, in execute
    async for event in agen:
      yield event
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\agents\base_agent.py", line 248, in run_async
    async for event in agen:
      yield event
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\agents\base_agent.py", line 238, in _run_with_trace
    async for event in agen:
      yield event
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\agents\sequential_agent.py", line 46, in _run_async_impl
    async for event in agen:
      yield event
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\agents\base_agent.py", line 248, in run_async
    async for event in agen:
      yield event
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\agents\base_agent.py", line 238, in _run_with_trace
    async for event in agen:
      yield event
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\agents\llm_agent.py", line 288, in _run_async_impl
    async for event in agen:
      self.__maybe_save_output_to_state(event)
      yield event
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\flows\llm_flows\base_llm_flow.py", line 401, in run_async
    async for event in agen:
      last_event = event
      yield event
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\flows\llm_flows\base_llm_flow.py", line 437, in _run_one_step_async
    async for llm_response in agen:
    ...<13 lines>...
          yield event
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\flows\llm_flows\base_llm_flow.py", line 686, in _call_llm_async
    if response := await self._handle_before_model_callback(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        invocation_context, llm_request, model_response_event
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\flows\llm_flows\base_llm_flow.py", line 805, in _handle_before_model_callback
    callback_response = await callback_response
                        ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\8304018\OneDrive - Wistron Corporation\Documents\GitLab\adks\google-adk-workflows\example_agents.py", line 127, in handler
    return await _process_initial_data(callback_context, llm_request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\8304018\OneDrive - Wistron Corporation\Documents\GitLab\adks\google-adk-workflows\example_agents.py", line 78, in _process_initial_data
    content=types.Content(
            ^^^^^^^^^^^^^
AttributeError: module 'google.generativeai.types' has no attribute 'Content'

ä½ å¯ä»¥å¾æœ¬ repo çš„å…¶ä»–ç¾æˆçš„ examples è£¡é¢ï¼Œæ‰¾åˆ° sample codeã€‚ 


ğŸ‰ 09:32 2025-10-10 Codex çš„æˆåŠŸå®£è¨€
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”€â”€â”€â”€â”€

> å‰›å‰›å®‰è£å®Œå¥—ä»¶å¾Œï¼Œgoogle.generativeai.types åœ¨ 0.7.x ç‰ˆè£¡å·²ç¶“ä¸å†æä¾› Content/Part é€™äº›å‹åˆ¥ï¼Œå› æ­¤æ‰æœƒå‡ºç¾ AttributeErrorã€‚æˆ‘æŠŠ example_agents.py çš„åŒ¯å…¥æ”¹å›
  ADK å…¶ä»–ç¯„ä¾‹ä¹Ÿåœ¨ç”¨çš„ google.genai.typesï¼ŒåŒæ™‚ä¿æŒåŸæœ¬è©³ç´°çš„ emoji loggingã€‚ç¾åœ¨è™•ç†æµç¨‹å¦‚ä¸‹ï¼š

  - example_agents.py:7 æ”¹æˆ import google.genai.types as typesï¼Œå›åˆ°å« Content/Part çš„æ¨¡çµ„ã€‚
  - å…©å€‹ async handler ä¸­å›å‚³ LlmResponse æ™‚ï¼Œæ”¹æˆ types.Content(role="model", parts=[types.Part(text=...)])ï¼Œå…¶å®ƒè¡Œç‚ºï¼ˆç‹€æ…‹å¿«ç…§ã€éŒ¯èª¤è™•ç†ã€emoji loggingï¼‰éƒ½
  é‚„åœ¨ã€‚

  è«‹é‡æ–°å•Ÿå‹• adk webï¼Œå†é¸ session_state_flowï¼Œé€™æ¬¡å°±ä¸æœƒå†å™´ Content æ‰¾ä¸åˆ°çš„éŒ¯èª¤ï¼Œè€Œä¸”è¼¸å…¥éæ•¸å­—æœƒè½åœ¨æˆ‘å€‘çš„éŒ¯èª¤è™•ç†ï¼Œæ—¥èªŒè£¡ä¹Ÿçœ‹å¾—åˆ°å®Œæ•´çš„ emoji è¨Šæ¯ã€‚


ğŸ‰ 09:29 2025-10-17 æˆåŠŸè·‘èµ·ä¾†äº†ï¼ 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æˆ‘é¦–å…ˆæ‰“ä¸ª Hiï¼Œç„¶åå¾—åˆ°ç¬¬ä¸€æ‰¹æˆæœï¼Œç»“æœæ˜¯ä¸ªé”™è¯¯ï¼Œå› ä¸ºå®ƒè¦æ±‚çš„æ˜¯æ•°å­—ã€‚æ¥ä¸‹æ¥æˆ‘æ‰“ä¸€ä¸ª 8ï¼ŒæŒ‰ä¸‹ Enterï¼Œå¾—åˆ°ç¬¬äºŒæ‰¹ç»“æœï¼Œè¿™æ¬¡æ˜¯æ­£ç¡®çš„ã€‚ 

	adk web
	----------------------
	hi

	éŒ¯èª¤ï¼šè«‹æä¾›å¯ä»¥è§£ææˆæ•´æ•¸çš„æ–‡å­—ã€‚

	éŒ¯èª¤ï¼šæœƒè©±ç‹€æ…‹ä¸­æ‰¾ä¸åˆ° 'processed_data'ã€‚

	8

	è¼¸å…¥å€¼ 8 å·²è™•ç†ï¼Œçµæœ 16 å·²å¯«å…¥æœƒè©±ç‹€æ…‹ã€‚

	å¾æœƒè©±ç‹€æ…‹è®€å–è³‡æ–™ 16ï¼Œæœ€çµ‚çµæœç‚º 26ã€‚

	Loggings screen dump 
	----------------------------
	2025-10-17 09:27:35,637 - INFO - envs.py:47 - Loaded .env file for session_state_flow at C:\Users\8304018\OneDrive - Wistron Corporation\Documents\GitLab\adks\google-adk-workflows\.env
	2025-10-17 09:27:35,640 - INFO - envs.py:47 - Loaded .env file for session_state_flow at C:\Users\8304018\OneDrive - Wistron Corporation\Documents\GitLab\adks\google-adk-workflows\.env
	2025-10-17 09:27:35,675 - INFO - agent_loader.py:126 - Found root_agent in session_state_flow.agent
	C:\Users\8304018\venvs\adks\Lib\site-packages\google\adk\cli\adk_web_server.py:330: UserWarning: [EXPERIMENTAL] App: This feature is experimental and may change or be removed in future versions without notice. It may introduce breaking changes at any time.
	  agentic_app = App(
	2025-10-17 09:27:35,688 - INFO - example_agents.py:48 - ğŸŒŸ [process_initial_data] Startingâ€¦
	2025-10-17 09:27:35,689 - INFO - example_agents.py:49 - ğŸ” [process_initial_data] Raw request object: 
		LlmRequest(
			model='gemini-1.5-flash', 
			contents = [
			    Content(
			        parts = [
			            Part(text = 'hi'),
			        ],
			        role = 'user')
			],
			config = GenerateContentConfig(
			  system_instruction='You are an agent. Your internal name is "process_initial_data".'  <---- æ‰¾ä¸åˆ°å®šç¾©ï¼Œé€™æ‡‰è©²æ˜¯ LlmAgent å…§å»ºçš„ã€‚ 
			), 
			live_connect_config=LiveConnectConfig(), 
			tools_dict={}
		)                                                        vvvvvvvvvvvvvvvvv ç¬¬ä¸€éš» Agent  
	2025-10-17 09:27:35,689 - INFO - example_agents.py:50 - ğŸ—ƒï¸ [process_initial_data] Session state before: <state unavailable>
	2025-10-17 09:27:35,690 - INFO - example_agents.py:56 - ğŸ“ [process_initial_data] Raw text from request: hi
	2025-10-17 09:27:35,690 - ERROR - example_agents.py:81 - âš ï¸ [process_initial_data] Error processing input: invalid literal for int() with base 10: 'hi'
	
																 vvvvvvvvvvvvvvvvvvv ç¬¬äºŒéš» Agent  
	2025-10-17 09:27:35,691 - INFO - example_agents.py:104 - ğŸŒŸ [use_and_finalize_data] Startingâ€¦
	2025-10-17 09:27:35,691 - INFO - example_agents.py:105 - ğŸ” [use_and_finalize_data] Raw request object: 
		LlmRequest(
			model='gemini-1.5-flash', 
			contents = [
			    Content(					      ğŸ… å¾é€™è£¡å¯ä»¥çœ‹å¾—å‡ºä¾†ï¼Œsequential agent å‰é¢çš„ context chart turns éƒ½æœ‰å‚³ä¸‹ä¾†ã€‚ 
			        parts = [
			            Part(text = 'hi'),
			        ],
			        role = 'user'),
			    Content(
			        parts = [
			            Part(text = 'For context:'),
			            Part(text = '[process_initial_data] said: éŒ¯èª¤ï¼šè«‹æä¾›å¯ä»¥è§£ææˆæ•´æ•¸çš„æ–‡å­—ã€‚'),
			        ],
			        role = 'user')
			], 
			config = GenerateContentConfig(
				system_instruction='You are an agent. Your internal name is "use_and_finalize_data".' <---- æ‰¾ä¸åˆ°å®šç¾©ï¼Œé€™æ‡‰è©²æ˜¯ LlmAgent å…§å»ºçš„ã€‚ 
			), 
			live_connect_config=LiveConnectConfig(), 
			tools_dict={}
		)
	2025-10-17 09:27:35,692 - INFO - example_agents.py:106 - ğŸ—ƒï¸ [use_and_finalize_data] Session state snapshot: <state unavailable>
	2025-10-17 09:27:35,692 - INFO - example_agents.py:109 - ğŸ“¦ [use_and_finalize_data] Retrieved processed_data: None
	2025-10-17 09:27:35,692 - WARNING - example_agents.py:127 - âš ï¸ [use_and_finalize_data] 'processed_data' not found in session state.
	INFO:     127.0.0.1:62298 - "GET /apps/session_state_flow/users/user/sessions/bd1c17c5-de90-4adc-ad7d-160f807ddacc HTTP/1.1" 200 OK
	INFO:     127.0.0.1:64334 - "GET /debug/trace/session/bd1c17c5-de90-4adc-ad7d-160f807ddacc HTTP/1.1" 200 OK
	INFO:     127.0.0.1:65245 - "POST /run_sse HTTP/1.1" 200 OK
	2025-10-17 09:28:44,442 - INFO - envs.py:47 - Loaded .env file for session_state_flow at C:\Users\8304018\OneDrive - Wistron Corporation\Documents\GitLab\adks\google-adk-workflows\.env
	2025-10-17 09:28:44,444 - INFO - example_agents.py:48 - ğŸŒŸ [process_initial_data] Startingâ€¦
	2025-10-17 09:28:44,444 - INFO - example_agents.py:49 - ğŸ” [process_initial_data] Raw request object: LlmRequest(model='gemini-1.5-flash', contents=[Content(
	  parts=[
		Part(
		  text='hi'
		),
	  ],
	  role='user'
	), Content(
	  parts=[
		Part(
		  text='éŒ¯èª¤ï¼šè«‹æä¾›å¯ä»¥è§£ææˆæ•´æ•¸çš„æ–‡å­—ã€‚'
		),
	  ],
	  role='model'
	), Content(
	  parts=[
		Part(
		  text='For context:'
		),
		Part(
		  text="[use_and_finalize_data] said: éŒ¯èª¤ï¼šæœƒè©±ç‹€æ…‹ä¸­æ‰¾ä¸åˆ° 'processed_data'ã€‚"
		),
	  ],
	  role='user'
	), Content(
	  parts=[
		Part(
		  text='8'
		),
	  ],
	  role='user'
	)], config=GenerateContentConfig(
	  system_instruction='You are an agent. Your internal name is "process_initial_data".'
	), live_connect_config=LiveConnectConfig(), tools_dict={})
	2025-10-17 09:28:44,446 - INFO - example_agents.py:50 - ğŸ—ƒï¸ [process_initial_data] Session state before: <state unavailable>
	2025-10-17 09:28:44,446 - INFO - example_agents.py:56 - ğŸ“ [process_initial_data] Raw text from request: 8
	2025-10-17 09:28:44,446 - INFO - example_agents.py:59 - ğŸŒŸ [process_initial_data] Parsed integer value: 8
	2025-10-17 09:28:44,447 - INFO - example_agents.py:62 - âœ… [process_initial_data] Processed value (input * 2): 16
	2025-10-17 09:28:44,447 - INFO - example_agents.py:65 - ğŸ’¾ [process_initial_data] Stored processed_data in session state: 16
	2025-10-17 09:28:44,447 - INFO - example_agents.py:69 - ğŸ—ƒï¸ [process_initial_data] Session state after: <state unavailable>
	2025-10-17 09:28:44,448 - INFO - example_agents.py:72 - ğŸ‰ [process_initial_data] Done. Response: è¼¸å…¥å€¼ 8 å·²è™•ç†ï¼Œçµæœ 16 å·²å¯«å…¥æœƒè©±ç‹€æ…‹ã€‚
	2025-10-17 09:28:44,450 - INFO - example_agents.py:104 - ğŸŒŸ [use_and_finalize_data] Startingâ€¦
	2025-10-17 09:28:44,450 - INFO - example_agents.py:105 - ğŸ” [use_and_finalize_data] Raw request object: LlmRequest(model='gemini-1.5-flash', contents=[Content(
	  parts=[
		Part(
		  text='hi'
		),
	  ],
	  role='user'
	), Content(
	  parts=[
		Part(
		  text='For context:'
		),
		Part(
		  text='[process_initial_data] said: éŒ¯èª¤ï¼šè«‹æä¾›å¯ä»¥è§£ææˆæ•´æ•¸çš„æ–‡å­—ã€‚'
		),
	  ],
	  role='user'
	), Content(
	  parts=[
		Part(
		  text="éŒ¯èª¤ï¼šæœƒè©±ç‹€æ…‹ä¸­æ‰¾ä¸åˆ° 'processed_data'ã€‚"
		),
	  ],
	  role='model'
	), Content(
	  parts=[
		Part(
		  text='8'
		),
	  ],
	  role='user'
	), Content(
	  parts=[
		Part(
		  text='For context:'
		),
		Part(
		  text='[process_initial_data] said: è¼¸å…¥å€¼ 8 å·²è™•ç†ï¼Œçµæœ 16 å·²å¯«å…¥æœƒè©±ç‹€æ…‹ã€‚'
		),
	  ],
	  role='user'
	)], config=GenerateContentConfig(
	  system_instruction='You are an agent. Your internal name is "use_and_finalize_data".'
	), live_connect_config=LiveConnectConfig(), tools_dict={})
	2025-10-17 09:28:44,452 - INFO - example_agents.py:106 - ğŸ—ƒï¸ [use_and_finalize_data] Session state snapshot: <state unavailable>
	2025-10-17 09:28:44,453 - INFO - example_agents.py:109 - ğŸ“¦ [use_and_finalize_data] Retrieved processed_data: 16
	2025-10-17 09:28:44,453 - INFO - example_agents.py:113 - âœ¨ [use_and_finalize_data] Final result (processed_data + 10): 26
	2025-10-17 09:28:44,453 - INFO - example_agents.py:119 - ğŸ‰ [use_and_finalize_data] Done. Response: å¾æœƒè©±ç‹€æ…‹è®€å–è³‡æ–™ 16ï¼Œæœ€çµ‚çµæœç‚º 26ã€‚
	INFO:     127.0.0.1:65245 - "GET /apps/session_state_flow/users/user/sessions/bd1c17c5-de90-4adc-ad7d-160f807ddacc HTTP/1.1" 200 OK
	INFO:     127.0.0.1:65245 - "GET /debug/trace/session/bd1c17c5-de90-4adc-ad7d-160f807ddacc HTTP/1.1" 200 OK
	2025-10-17 09:37:11,028 - INFO - agent_change_handler.py:43 - Change detected in agents directory: C:\Users\8304018\OneDrive - Wistron Corporation\Documents\GitLab\adks\google-adk-workflows\example_agents.py
	2025-10-17 09:37:11,029 - INFO - agent_change_handler.py:43 - Change detected in agents directory: C:\Users\8304018\OneDrive - Wistron Corporation\Documents\GitLab\adks\google-adk-workflows\subagent.py
	2025-10-17 09:37:11,035 - INFO - agent_change_handler.py:43 - Change detected in agents directory: C:\Users\8304018\OneDrive - Wistron Corporation\Documents\GitLab\adks\google-adk-workflows\.ipynb_checkpoints\subagent-checkpoint.py
